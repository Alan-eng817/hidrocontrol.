<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>HidroControl - Gest√£o Industrial</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, addDoc, serverTimestamp, query, onSnapshot, doc, getDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

        window.FB_CORE = { initializeApp, getFirestore, collection, addDoc, serverTimestamp, query, onSnapshot, getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken, doc, getDoc };
    </script>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; transition: background-color 0.3s ease; }
        .hide-scroll::-webkit-scrollbar { display: none; }
        input[type="number"]::-webkit-inner-spin-button, input[type="number"]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
        
        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        .tag-dropdown { animation: slideDown 0.2s ease-out; z-index: 100; }
        .success-overlay { animation: fadeIn 0.4s ease-out forwards; backdrop-filter: blur(10px); }
        
        /* Glass effect utilities */
        .glass-dark { background: rgba(15, 23, 42, 0.8); border: 1px solid rgba(255, 255, 255, 0.1); backdrop-filter: blur(12px); }
        .glass-light { background: rgba(255, 255, 255, 0.8); border: 1px solid rgba(0, 0, 0, 0.05); backdrop-filter: blur(12px); }
    </style>
</head>
<body class="overflow-x-hidden">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // =========================================================
        // CONFIGURA√á√ÉO DAS CHAVES (COLE AS SUAS AQUI PARA O VERCEL)
        // =========================================================
        const CONFIG_MANUAL_FIREBASE = {
            apiKey: "",           // Cole aqui
            authDomain: "",       // Cole aqui
            projectId: "",        // Cole aqui
            storageBucket: "",    // Cole aqui
            messagingSenderId: "",// Cole aqui
            appId: ""             // Cole aqui
        };
        // =========================================================

        // --- √çcones ---
        const IconClipboard = () => <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><rect width="8" height="4" x="8" y="2" rx="1" ry="1"/><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/></svg>;
        const IconSend = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>;
        const IconSave = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>;
        const IconChart = () => <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><path d="M3 3v18h18"/><path d="m19 9-5 5-4-4-3 3"/></svg>;
        const IconCheck = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><path d="M20 6 9 17l-5-5"/></svg>;
        const IconPlus = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>;
        const IconCamera = () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/><circle cx="12" cy="13" r="3"/></svg>;
        const IconSun = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>;
        const IconMoon = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>;

        const App = () => {
            const [view, setView] = useState('form'); 
            const [theme, setTheme] = useState('dark');
            const [user, setUser] = useState(null);
            const [db, setDb] = useState(null);
            const [historyData, setHistoryData] = useState([]);
            const [saveSuccess, setSaveSuccess] = useState(false);
            const [isSaving, setIsSaving] = useState(false);
            const [activeDropdownIndex, setActiveDropdownIndex] = useState(null);
            const [syncStatus, setSyncStatus] = useState('A conectar...');
            
            const appId = typeof __app_id !== 'undefined' ? __app_id : 'hidrocontrol-vercel-prod';

            const [items, setItems] = useState([{ 
                equipamento: '', 
                tubosLimpos: '', 
                tubosObstruidos: '', 
                tubosComFerro: '', 
                impactos: '', 
                observacoes: '',
                fotoAntes: null,
                fotoDepois: null
            }]);

            const [globalInfo, setGlobalInfo] = useState({
                data: new Date().toLocaleDateString('pt-BR'),
                empresa: 'Montisol',
                turno: 'ADM'
            });

            const equipamentosLista = [
                '025A-TC-21A','025A-TC-21B','025A-TC-21C','025A-TC-21D','025A-TC-21E','025A-TC-21F',
                '030-TC-001','030-TC-002','030-TC-003','030-TC-004','030-TC-005','030-TC-010',
                '030-TC-11A','030-TC-11B','030-TC-22A','030-TC-22B','030-TC-24A','030-TC-24B',
                '040-TC-011','042-TC-011','042-TC-016','042-TC-017','042-TC-018','042-TC-019',
                '042-TC-021','042-TC-026','042-TC-027','042-TC-028','042-TC-029',
                '042-TC-031','042-TC-036','042-TC-037','042-TC-038','042-TC-039','030-VA-16'
            ].sort();

            useEffect(() => {
                const initialize = async () => {
                    let count = 0;
                    while (!window.FB_CORE && count < 50) {
                        await new Promise(r => setTimeout(r, 100));
                        count++;
                    }
                    if (!window.FB_CORE) return;

                    const { initializeApp, getFirestore, getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken } = window.FB_CORE;
                    
                    try {
                        let config;
                        const configStr = typeof __firebase_config !== 'undefined' ? __firebase_config : null;
                        
                        if (configStr) {
                            config = JSON.parse(configStr);
                        } else if (CONFIG_MANUAL_FIREBASE.projectId) {
                            config = CONFIG_MANUAL_FIREBASE;
                        } else {
                            setSyncStatus('CONFIGURA√á√ÉO AUSENTE');
                            return;
                        }

                        const appInstance = initializeApp(config);
                        const authInstance = getAuth(appInstance);
                        const firestoreInstance = getFirestore(appInstance);
                        setDb(firestoreInstance);

                        if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                            await signInWithCustomToken(authInstance, __initial_auth_token);
                        } else {
                            await signInAnonymously(authInstance);
                        }

                        onAuthStateChanged(authInstance, (u) => {
                            if (u) {
                                setUser(u);
                                setSyncStatus('ONLINE');
                            }
                        });
                    } catch (e) {
                        setSyncStatus('ERRO DE CONFIG');
                    }
                };
                initialize();
            }, []);

            useEffect(() => {
                if (!user || !db || !window.FB_CORE) return;
                const { collection, onSnapshot } = window.FB_CORE;
                const colRef = collection(db, 'artifacts', appId, 'public', 'data', 'relatorios');
                
                const unsubscribe = onSnapshot(colRef, (snapshot) => {
                    const data = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    data.sort((a, b) => (b.localTimestamp || 0) - (a.localTimestamp || 0));
                    setHistoryData(data);
                });
                
                return () => unsubscribe();
            }, [user, db]);

            const updateItem = (idx, field, val) => {
                const newItems = [...items];
                newItems[idx] = { ...newItems[idx], [field]: val };
                setItems(newItems);
            };

            const handlePhoto = (idx, field) => {
                // Simula√ß√£o de captura de foto
                updateItem(idx, field, "Foto Capturada");
            };

            const handleSave = async () => {
                if (!db || !user) return;
                setIsSaving(true);
                try {
                    const { collection, addDoc, serverTimestamp } = window.FB_CORE;
                    await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'relatorios'), {
                        ...globalInfo,
                        items,
                        userId: user.uid,
                        localTimestamp: Date.now(),
                        createdAt: serverTimestamp()
                    });
                    setSaveSuccess(true);
                    setTimeout(() => { 
                        setSaveSuccess(false); 
                        setView('dashboard'); 
                        setItems([{ equipamento: '', tubosLimpos: '', tubosObstruidos: '', tubosComFerro: '', impactos: '', observacoes: '', fotoAntes: null, fotoDepois: null }]); 
                    }, 2000);
                } catch (e) { alert("Erro ao salvar."); }
                finally { setIsSaving(false); }
            };

            const handleWhatsApp = () => {
                let msg = `*RELAT√ìRIO HIDROJATO - ${globalInfo.empresa.toUpperCase()}*%0AüìÖ ${globalInfo.data}%0Aüïí ${globalInfo.turno}%0A%0A`;
                items.forEach((it, i) => {
                    msg += `*${i+1}. TAG: ${it.equipamento}*%0A‚úÖ Limpos: ${it.tubosLimpos || 0}%0A‚ùå Obs: ${it.tubosObstruidos || 0}%0A‚ö†Ô∏è Ferro: ${it.tubosComFerro || 0}%0A`;
                    if(it.impactos) msg += `üí• Impactos: ${it.impactos}%0A`;
                    if(it.observacoes) msg += `üìù Obs: ${it.observacoes}%0A`;
                    msg += `%0A`;
                });
                window.open(`https://wa.me/?text=${msg}`, '_blank');
            };

            // Estilos din√¢micos baseados no tema
            const bgClass = theme === 'dark' ? 'bg-slate-950 text-white' : 'bg-slate-50 text-slate-900';
            const cardClass = theme === 'dark' ? 'glass-dark' : 'glass-light';
            const inputClass = theme === 'dark' ? 'bg-slate-900 border-slate-800 text-indigo-400' : 'bg-white border-slate-200 text-indigo-600';
            const labelClass = theme === 'dark' ? 'text-slate-500' : 'text-slate-400';
            const navClass = theme === 'dark' ? 'bg-slate-900/80 border-white/5' : 'bg-white/90 border-slate-200';

            return (
                <div className={`min-h-screen flex flex-col max-w-lg mx-auto relative transition-colors duration-300 ${bgClass}`}>
                    
                    {/* Header Premium */}
                    <header className={`p-7 sticky top-0 z-40 shadow-2xl flex items-center justify-between rounded-b-[2.5rem] border-b ${theme === 'dark' ? 'bg-gradient-to-br from-blue-900 to-slate-950 border-white/5' : 'bg-gradient-to-br from-blue-600 to-blue-800 border-blue-400/20 text-white'}`}>
                        <div className="flex items-center gap-3">
                            <div className="bg-white/10 p-2 rounded-xl border border-white/10 shadow-inner">
                                <IconClipboard />
                            </div>
                            <h1 className="font-black text-2xl tracking-tighter uppercase">Hidro<span className={theme === 'dark' ? "text-blue-400" : "text-blue-100"}>Control</span></h1>
                        </div>
                        <div className="flex items-center gap-4">
                            <button 
                                onClick={() => setTheme(theme === 'dark' ? 'light' : 'dark')}
                                className="p-2.5 rounded-xl bg-white/10 border border-white/10 hover:bg-white/20 transition-all active:scale-90"
                                title="Alternar Tema"
                            >
                                {theme === 'dark' ? <IconSun /> : <IconMoon />}
                            </button>
                            <div className="text-right hidden sm:block">
                                <div className="text-[10px] font-black bg-blue-500/20 text-blue-100 px-3 py-1.5 rounded-full border border-blue-500/30 uppercase mb-1 tracking-widest">{globalInfo.data}</div>
                                <div className={`text-[8px] font-black tracking-widest ${syncStatus === 'ONLINE' ? 'text-green-400' : 'text-red-400'}`}>{syncStatus}</div>
                            </div>
                        </div>
                    </header>

                    <main className="flex-grow p-5 space-y-6 overflow-y-auto hide-scroll pb-32">
                        {view === 'form' ? (
                            <div className="space-y-6 animate-in slide-in-from-bottom duration-500">
                                <section className="grid grid-cols-2 gap-3">
                                    {['Montisol', 'Constec'].map(e => (
                                        <button key={e} onClick={() => setGlobalInfo({...globalInfo, empresa: e})} className={`py-4 rounded-2xl font-black text-[10px] uppercase tracking-widest border-2 transition-all ${globalInfo.empresa === e ? 'bg-indigo-600 border-indigo-400 text-white shadow-lg scale-105' : theme === 'dark' ? 'bg-slate-900 border-slate-800 text-slate-500' : 'bg-white border-slate-200 text-slate-400'}`}>{e}</button>
                                    ))}
                                </section>
                                
                                <section className="grid grid-cols-3 gap-3">
                                    {['ADM', 'T.C', 'T.A'].map(t => (
                                        <button key={t} onClick={() => setGlobalInfo({...globalInfo, turno: t})} className={`py-4 rounded-2xl font-black text-[10px] uppercase tracking-widest border-2 transition-all ${globalInfo.turno === t ? 'bg-indigo-600 border-indigo-400 text-white shadow-lg scale-105' : theme === 'dark' ? 'bg-slate-900 border-slate-800 text-slate-500' : 'bg-white border-slate-200 text-slate-400'}`}>{t}</button>
                                    ))}
                                </section>

                                {items.map((it, idx) => (
                                    <div key={idx} className={`${cardClass} p-6 space-y-6 border-l-8 border-l-blue-500 shadow-2xl relative overflow-hidden transition-all duration-300`}>
                                        <div>
                                            <label className={`text-[10px] font-black uppercase tracking-widest mb-2 block ${labelClass}`}>1. EQUIPAMENTO (TAG)</label>
                                            <input type="text" placeholder="Pesquisar..." value={it.equipamento} onFocus={() => setActiveDropdownIndex(idx)} onChange={(e) => updateItem(idx, 'equipamento', e.target.value.toUpperCase())} className={`w-full p-4 rounded-2xl outline-none focus:ring-2 focus:ring-indigo-500 transition-all font-mono font-black text-sm border ${inputClass}`} />
                                            {activeDropdownIndex === idx && (
                                                <div className={`absolute z-50 left-0 right-0 mt-3 tag-dropdown max-h-48 overflow-y-auto rounded-2xl shadow-2xl border ${theme === 'dark' ? 'bg-slate-800 border-white/10' : 'bg-white border-slate-200'}`}>
                                                    {equipamentosLista.filter(tag => tag.includes(it.equipamento)).map(tag => (
                                                        <div key={tag} onClick={() => { updateItem(idx, 'equipamento', tag); setActiveDropdownIndex(null); }} className={`px-5 py-4 border-b border-white/5 hover:bg-blue-500/10 font-black text-xs cursor-pointer uppercase tracking-tighter ${theme === 'dark' ? 'text-white' : 'text-slate-800'}`}>{tag}</div>
                                                    ))}
                                                </div>
                                            )}
                                        </div>

                                        <div className="grid grid-cols-3 gap-4">
                                            <div className="space-y-1"><label className={`text-[9px] font-black uppercase text-center block tracking-tighter ${labelClass}`}>Limpos</label><input type="number" value={it.tubosLimpos} onChange={(e) => updateItem(idx, 'tubosLimpos', e.target.value)} placeholder="0" className={`w-full p-4 rounded-2xl text-center font-black text-lg border ${inputClass.replace('indigo', 'green')}`} /></div>
                                            <div className="space-y-1"><label className={`text-[9px] font-black uppercase text-center block tracking-tighter ${labelClass}`}>Obs.</label><input type="number" value={it.tubosObstruidos} onChange={(e) => updateItem(idx, 'tubosObstruidos', e.target.value)} placeholder="0" className={`w-full p-4 rounded-2xl text-center font-black text-lg border ${inputClass.replace('indigo', 'slate')}`} /></div>
                                            <div className="space-y-1"><label className={`text-[9px] font-black uppercase text-center block tracking-tighter ${labelClass}`}>Ferro</label><input type="number" value={it.tubosComFerro} onChange={(e) => updateItem(idx, 'tubosComFerro', e.target.value)} placeholder="0" className={`w-full p-4 rounded-2xl text-center font-black text-lg border ${inputClass}`} /></div>
                                        </div>

                                        {/* EVID√äNCIAS FOTOGR√ÅFICAS */}
                                        <div className="grid grid-cols-2 gap-4">
                                            <button 
                                                onClick={() => handlePhoto(idx, 'fotoAntes')}
                                                className={`flex flex-col items-center justify-center p-4 rounded-2xl border-2 border-dashed transition-all ${it.fotoAntes ? 'bg-green-500/10 border-green-500 text-green-500' : 'bg-slate-500/5 border-slate-700 text-slate-500 hover:border-indigo-500 hover:text-indigo-400'}`}
                                            >
                                                <IconCamera />
                                                <span className="text-[9px] font-black uppercase mt-2 tracking-widest">{it.fotoAntes ? 'FOTO ANTES OK' : 'FOTO ANTES'}</span>
                                            </button>
                                            <button 
                                                onClick={() => handlePhoto(idx, 'fotoDepois')}
                                                className={`flex flex-col items-center justify-center p-4 rounded-2xl border-2 border-dashed transition-all ${it.fotoDepois ? 'bg-green-500/10 border-green-500 text-green-500' : 'bg-slate-500/5 border-slate-700 text-slate-500 hover:border-indigo-500 hover:text-indigo-400'}`}
                                            >
                                                <IconCamera />
                                                <span className="text-[9px] font-black uppercase mt-2 tracking-widest">{it.fotoDepois ? 'FOTO DEPOIS OK' : 'FOTO DEPOIS'}</span>
                                            </button>
                                        </div>

                                        <div className="space-y-4">
                                            <div>
                                                <label className={`text-[10px] font-black uppercase tracking-widest mb-2 block ${labelClass}`}>Evid√™ncias de Impactos</label>
                                                <textarea value={it.impactos} onChange={(e) => updateItem(idx, 'impactos', e.target.value)} placeholder="Relate os impactos industriais..." className={`w-full p-4 rounded-2xl outline-none focus:ring-2 focus:ring-indigo-500 transition-all font-medium text-xs min-h-[80px] resize-none border ${inputClass}`} />
                                            </div>
                                            <div>
                                                <label className={`text-[10px] font-black uppercase tracking-widest mb-2 block ${labelClass}`}>Observa√ß√µes Gerais</label>
                                                <textarea value={it.observacoes} onChange={(e) => updateItem(idx, 'observacoes', e.target.value)} placeholder="Notas do turno e anomalias..." className={`w-full p-4 rounded-2xl outline-none focus:ring-2 focus:ring-indigo-500 transition-all font-medium text-xs min-h-[80px] resize-none border ${inputClass}`} />
                                            </div>
                                        </div>
                                    </div>
                                ))}
                                
                                <button onClick={() => setItems([...items, { equipamento: '', tubosLimpos: '', tubosObstruidos: '', tubosComFerro: '', impactos: '', observacoes: '', fotoAntes: null, fotoDepois: null }])} className={`w-full py-5 rounded-[2rem] border-2 border-dashed font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-2 active:scale-95 transition-all ${theme === 'dark' ? 'bg-slate-900 border-slate-800 text-indigo-400' : 'bg-slate-100 border-slate-200 text-indigo-600'}`}><IconPlus /> Adicionar Novo Equipamento</button>

                                <button onClick={() => setView('preview')} className="w-full bg-indigo-600 hover:bg-indigo-500 text-white py-6 rounded-3xl font-black uppercase tracking-[0.25em] text-[11px] shadow-2xl active:scale-95 transition-all">Revisar Relat√≥rio</button>
                            </div>
                        ) : view === 'dashboard' ? (
                            <div className="space-y-6 animate-in fade-in duration-700">
                                <div className={`${cardClass} p-8 text-center border-t-8 border-t-indigo-500 shadow-xl`}>
                                    <p className={`text-[11px] font-black uppercase tracking-widest mb-3 ${labelClass}`}>PRODU√á√ÉO TOTAL (TUBOS)</p>
                                    <div className="flex justify-center items-baseline gap-2">
                                        <h2 className={`text-6xl font-black tracking-tighter ${theme === 'dark' ? 'text-white' : 'text-slate-900'}`}>{historyData.reduce((acc, rel) => acc + (rel.items || []).reduce((a, i) => a + Number(i.tubosLimpos), 0), 0)}</h2>
                                        <span className="text-indigo-500 font-bold text-xs uppercase">Limpos</span>
                                    </div>
                                </div>
                                <div className="space-y-4">
                                    <h3 className={`text-[10px] font-black uppercase tracking-[0.3em] px-4 ${labelClass}`}>Hist√≥rico Sincronizado</h3>
                                    {historyData.slice(0, 8).map(rel => (
                                        <div key={rel.id} className={`${cardClass} p-5 flex items-center justify-between border-l-4 border-l-indigo-500 transition-transform active:scale-95 cursor-pointer`}>
                                            <div>
                                                <p className={`text-xs font-black ${theme === 'dark' ? 'text-white' : 'text-slate-800'}`}>{rel.data} ‚Ä¢ {rel.turno}</p>
                                                <p className="text-[9px] font-bold text-slate-500 uppercase tracking-tighter">{rel.empresa} ‚Ä¢ {(rel.items || []).length} TAGs</p>
                                            </div>
                                            <div className="text-green-500 font-black text-sm">+{ (rel.items || []).reduce((a,i) => a + Number(i.tubosLimpos), 0) }</div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        ) : (
                            <div className="space-y-8 animate-in zoom-in-95 duration-500 pt-4">
                                <div className={`${theme === 'dark' ? 'bg-[#0a0a0c]' : 'bg-slate-800'} p-8 rounded-[3.5rem] shadow-2xl border border-white/5 text-white relative`}>
                                    <h2 className="text-slate-500 font-black uppercase text-[10px] tracking-[0.4em] mb-8">Resumo Final do Turno</h2>
                                    {items.map((it, i) => (
                                        <div key={i} className="mb-8 last:mb-0 border-l-2 border-indigo-500/30 pl-5 space-y-2">
                                            <p className="text-white font-black text-base uppercase tracking-tighter">{i+1}. TAG: {it.equipamento}</p>
                                            <div className="flex flex-wrap gap-4 font-mono text-[10px] font-bold">
                                                <span className="text-green-400">‚úÖ {it.tubosLimpos || 0} L</span>
                                                <span className="text-slate-400">‚ùå {it.tubosObstruidos || 0} O</span>
                                                <span className="text-indigo-400">‚ö†Ô∏è {it.tubosComFerro || 0} F</span>
                                                <span className="text-blue-400">üì∏ {it.fotoAntes && it.fotoDepois ? 'FOTOS OK' : 'SEM FOTOS'}</span>
                                            </div>
                                            {(it.impactos || it.observacoes) && (
                                                <div className="bg-white/5 p-3 rounded-xl mt-2">
                                                    {it.impactos && <p className="text-[9px] text-slate-400 mb-1 leading-relaxed"><span className="text-indigo-300 font-black">IMPACTOS:</span> {it.impactos}</p>}
                                                    {it.observacoes && <p className="text-[9px] text-slate-400 leading-relaxed"><span className="text-indigo-300 font-black">NOTAS:</span> {it.observacoes}</p>}
                                                </div>
                                            )}
                                        </div>
                                    ))}
                                </div>
                                <div className="space-y-3 pb-10">
                                    <button onClick={handleSave} disabled={isSaving || syncStatus !== 'ONLINE'} className="w-full bg-indigo-600 text-white py-6 rounded-[2.5rem] font-black uppercase text-[10px] flex items-center justify-center gap-3 active:scale-95 disabled:opacity-20 transition-all tracking-widest shadow-[0_0_30px_rgba(79,70,229,0.4)]">
                                        {isSaving ? 'A Sincronizar...' : <><IconSave /> Gravar na Cloud Industrial</>}
                                    </button>
                                    <div className="flex gap-4">
                                        <button onClick={() => setView('form')} className={`flex-1 py-5 rounded-[2.5rem] font-black uppercase text-[9px] border transition-colors ${theme === 'dark' ? 'bg-white/5 border-white/10 text-slate-400' : 'bg-white border-slate-200 text-slate-500'}`}>Voltar</button>
                                        <button onClick={handleWhatsApp} className="flex-[2] bg-green-500 hover:bg-green-400 text-white py-5 rounded-[2.5rem] font-black uppercase text-[9px] flex items-center justify-center gap-2 active:scale-95 tracking-widest shadow-lg">
                                            <IconSend /> WhatsApp
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}
                    </main>

                    {saveSuccess && (
                        <div className="success-overlay fixed inset-0 z-50 flex items-center justify-center p-6 bg-slate-950/95">
                            <div className={`${cardClass} p-12 text-center shadow-[0_0_100px_rgba(79,70,229,0.2)] animate-in zoom-in duration-500 max-w-[80%]`}>
                                <div className="bg-indigo-600 text-white w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-8 shadow-xl animate-bounce"><IconCheck /></div>
                                <h3 className={`font-black uppercase text-2xl tracking-tighter ${theme === 'dark' ? 'text-white' : 'text-slate-900'}`}>Dados Gravados com Sucesso!</h3>
                                <p className="text-indigo-500 text-xs font-bold mt-3 uppercase tracking-widest">Sincroniza√ß√£o Cloud Conclu√≠da</p>
                            </div>
                        </div>
                    )}

                    <nav className={`fixed bottom-0 left-1/2 -translate-x-1/2 w-full max-w-lg backdrop-blur-2xl border-t px-12 py-6 flex justify-around items-center z-40 rounded-t-[3.5rem] shadow-[0_-20px_50px_rgba(0,0,0,0.2)] transition-colors duration-300 ${navClass}`}>
                        <button onClick={() => setView('form')} className={`flex flex-col items-center transition-all duration-300 ${view !== 'dashboard' ? 'text-indigo-500 scale-125' : 'text-slate-400'}`}>
                            <IconClipboard /><span className="text-[8px] font-black uppercase mt-1.5 tracking-tighter">Relat√≥rio</span>
                        </button>
                        <button onClick={() => setView('dashboard')} className={`flex flex-col items-center transition-all duration-300 ${view === 'dashboard' ? 'text-indigo-500 scale-125' : 'text-slate-400'}`}>
                            <IconChart /><span className="text-[8px] font-black uppercase mt-1.5 tracking-tighter">Hist√≥rico</span>
                        </button>
                    </nav>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
